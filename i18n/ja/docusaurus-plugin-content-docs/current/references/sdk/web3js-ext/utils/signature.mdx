# 署名

シグネチャをオブジェクトからタプル形式に変換し、シグネチャをコンパクトにする。

<CH.Spotlight>
  <CH.Code>
    ```js signatureUtils.js
    const { getSignatureTuple } = require('@kaiachain/web3js-ext')

    async function main() {
      console.log(
        'signature from { v, r, s } object =',
        getSignatureTuple({
          v: 27,
          r: '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b99',
          s: '0x75c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c508',
        })
      )
      console.log(
        'signature from compact 65 bytes =',
        getSignatureTuple(
          '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b9975c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c5081b'
        )
      )
    }

    main()
    ```

    ---

    ```zsh output
    ❯ node signatureUtils.js
    signature from { v, r, s } object = [
      '0x1b',
      '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b99',
      '0x75c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c508'
    ]
    signature from compact 65 bytes = [
      '0x1b',
      '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b99',
      '0x75c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c508'
    ]
    ```
  </CH.Code>

  ---

  **getSignatureTuple**を\*\*@kaiachain/web3js-ext\*\*パッケージからインポートする。

  ```js signatureUtils.js focus=1
  ```

  ---

  `{r, s, v}` フォーマットの公開鍵をタプルに圧縮するには、**signature オブジェクト** をパラメータとして `getSignatureTuple` を使用する。

  <CH.Code>
    ```js signatureUtils.js focus=4:11
    const { getSignatureTuple } = require('@kaiachain/web3js-ext')

    async function main() {
      console.log(
        'signature from { v, r, s } object =',
        getSignatureTuple({
          v: 27,
          r: '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b99',
          s: '0x75c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c508',
        })
      )
    }

    main()
    ```

    ---

    ```zsh output
    ❯ node signatureUtils.js
    signature from { v, r, s } object = [
      '0x1b',
      '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b99',
      '0x75c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c508'
    ]
    ```
  </CH.Code>

  ---

  公開鍵を65バイトのコンパクトな形式からタプルに圧縮するには、**コンパクトな署名**を引数として `getSignatureTuple` を使用する。

  <CH.Code>
    ```js signatureUtils.js focus=4:9
    const { getSignatureTuple } = require('@kaiachain/web3js-ext')

    async function main() {
      console.log(
        'signature from compact 65 bytes =',
        getSignatureTuple(
          '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b9975c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c5081b'
        )
      )
    }

    main()
    ```

    ---

    ```zsh output
    ❯ node signatureUtils.js
    signature from compact 65 bytes = [
      '0x1b',
      '0x66809fb130a6ea4ae4e823baa92573a5f1bfb4e88e64048aecfb18a2b4012b99',
      '0x75c2c3e5f7b0a182c767137c488649cd5104a5e747371fd922d618e328e5c508'
    ]
    ```
  </CH.Code>
</CH.Spotlight>
